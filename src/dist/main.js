(()=>{"use strict";var t={12:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});class s{}e.default=s,s.MU0=[[75,8],[67,5],[43,6],[30,10]],s.LOG_SIGMA0=[[2.2,.4],[2.4,.4],[2.4,.4],[2.5,.5]],s.ADR=.7,s.MU0_adj=0,s.D_MU0=[0,4],s.path_to_fig="./fig/fig_back.png",s.CENTERS=[[218,100],[289,100],[360,100],[218,150],[289,150],[360,150]],s.Rnormal=20,s.RnormalCenter=3,s.Rrespond=18,s.RrespondCenter=2,s.ProbThreshold=.05,s.storageNameSpeed="SimLaSpeed",s.storageNameLang="SimLaLang"},347:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{static drawCircle(t,e,s,a,i){t.beginPath(),t.arc(e[0],e[1],s,0,2*Math.PI,!0),t.strokeStyle=i,t.lineWidth=2,t.stroke(),t.closePath(),t.beginPath(),t.arc(e[0],e[1],a,0,2*Math.PI,!1),t.fillStyle=i,t.fill(),t.closePath()}static fillRect(t,e,s){const a=1.3*s;t.fillStyle="#f4d7d7",t.fillRect(e[0]-a,e[1]-a,2*a,2*a)}}},419:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});class s{}e.default=s,s.start=["開始","Start"],s.restart=["再開","Restart"],s.pause=["一時停止","Pause"],s.newexp=["新規実験","New Exp."],s.quit=["終了","Quit"],s.with_response=["反応あり","Respond"],s.without_response=["反応なし","Not Respond"],s.speed=["倍速","x speed"],s.msg_newexp=["新規実験を行いますか?","Do you want to start a new experiment?"],s.msg_quit=["終了しますか?","Do you want to quit?"],s.msg_close=["ブラウザあるいはこのタブを閉じて下さい","Please close the browser or this tab"]},331:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{static inv_logit(t){return 1/(1+Math.exp(-t))}static inv_logit_upper(t){return 1/(1+Math.exp(t))}static phi_approx(t){return this.inv_logit(.07056*Math.pow(t,3)+1.5976*t)}static phi_approx_upper(t){return this.inv_logit_upper(.07056*Math.pow(t,3)+1.5976*t)}static random_norm(t=0,e=1){let s=Math.random(),a=Math.random();return t+Math.sqrt(-2*Math.log(s))*Math.cos(2*Math.PI*a)*e}}},314:function(t,e,s){var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=a(s(12)),r=a(s(331));e.default=class{constructor(){this.param=[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],this.storageName="SimLaParam";const t=this.getStorage();Object.keys(t).length>0?this.param=t.param:this.setInitParameter()}setInitParameter(){const t=i.default.MU0_adj+r.default.random_norm(i.default.D_MU0[0],i.default.D_MU0[1]);for(let e=1;e<5;e++)this.param[e][0]=r.default.random_norm(i.default.MU0[e-1][0]+t,i.default.MU0[e-1][1]),this.param[e][1]=Math.exp(r.default.random_norm(i.default.LOG_SIGMA0[e-1][0],i.default.LOG_SIGMA0[e-1][1]));this.param[5][0]=this.param[2][0],this.param[5][1]=this.param[2][1],this.param[5][2]=i.default.ADR,this.setStorage()}get getParameter(){return this.param}setStorage(){localStorage.setItem(this.storageName,JSON.stringify({param:this.param}))}getStorage(){const t=localStorage.getItem(this.storageName);return t?JSON.parse(t):{}}clearStorage(){localStorage.removeItem(this.storageName)}}},158:function(t,e,s){var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=a(s(12)),r=a(s(419)),l=a(s(314)),n=a(s(347)),o=a(s(250)),h=a(s(331));e.default=class{constructor(){this.time=new o.default,this.param=new l.default,this.elem_newexp=document.getElementById("newexp"),this.elem_start=document.getElementById("start"),this.elem_quit=document.getElementById("quit"),this.elem_speed_msg=document.getElementById("speed_msg"),this.elem_timer=document.getElementById("timer"),this.elem_response=document.getElementById("response"),this.elem_lang=document.getElementById("lang"),this.elem_slider=document.getElementById("slider"),this.elem_canvas=document.getElementById("canvas");const t=this.elem_canvas.getContext("2d"),e=new Image;e.src=i.default.path_to_fig,e.onload=()=>{t.drawImage(e,0,0),i.default.CENTERS.forEach((function(e){n.default.drawCircle(t,e,i.default.Rnormal,i.default.RnormalCenter,"black")}))};const s=void 0===window.ontouchstart?"mousedown":"touchstart";this.elem_newexp.addEventListener(s,(()=>{this.clickNewExp()}),!1),this.elem_start.addEventListener(s,(()=>{this.clickStart()}),!1),this.elem_quit.addEventListener(s,(()=>{this.clickQuit()}),!1),this.elem_lang.addEventListener("change",(()=>{this.toggleLang()}),!1),this.elem_slider.addEventListener("input",(()=>{this.sliderChanged()}),!1),this.elem_canvas.addEventListener(s,(e=>{this.clickCanvas(this.elem_canvas,t,e)}),!1),this.elem_slider.value=this.getStorageSpeed(),this.lang=this.getStorageLang(),this.elem_lang.la[this.lang].checked=!0,this.setLang(),this.toggleButton(),this.elem_timer.textContent="0:00:00"}start(){this.displayTimer()}clickCanvas(t,e,s){if(!this.time.isRunning)return;const a=this.getClickedPosition(t,s),l=this.getCircleNumber(a,i.default.CENTERS,i.default.Rnormal);l<0||(this.getResponse(l,this.time.getMinute,this.param.getParameter)?(n.default.fillRect(e,i.default.CENTERS[l],i.default.Rrespond),n.default.drawCircle(e,i.default.CENTERS[l],i.default.Rrespond,i.default.RrespondCenter,"red"),this.elem_response.textContent=r.default.with_response[this.lang],this.elem_response.style.color="red",setTimeout((()=>{n.default.fillRect(e,i.default.CENTERS[l],i.default.Rrespond),n.default.drawCircle(e,i.default.CENTERS[l],i.default.Rnormal,i.default.RnormalCenter,"black"),this.elem_response.textContent=""}),300)):(this.elem_response.textContent=r.default.without_response[this.lang],this.elem_response.style.color="black",setTimeout((()=>{this.elem_response.textContent=""}),300)))}toggleLang(){this.lang=this.elem_lang.la.value,this.setLang(),this.setStorageLang()}setLang(){let t;t=this.time.isRunning?r.default.pause:0==this.time.getTotalTime?r.default.start:r.default.restart,this.elem_start.textContent=t[this.lang],this.elem_newexp.textContent=r.default.newexp[this.lang],this.elem_quit.textContent=r.default.quit[this.lang],this.toggleButton(),this.printSpeed(this.elem_slider.value)}clickNewExp(){this.time.isRunning||window.confirm(r.default.msg_newexp[this.lang])&&(this.time.clickNewExp(),this.param.setInitParameter(),this.elem_slider.value="1",this.setStorageSpeed(),this.setLang())}clickStart(){this.time.clickStart(),this.setLang(),this.toggleButton(),this.setStorageSpeed()}clickQuit(){this.time.isRunning||window.confirm(r.default.msg_quit[this.lang])&&(window.alert(r.default.msg_close[this.lang]),this.time.clickQuit(),this.param.clearStorage(),this.clearStorage())}toggleButton(){this.time.isRunning?(this.elem_newexp.style.color="gray",this.elem_quit.style.color="gray"):(this.elem_newexp.style.color="black",this.elem_quit.style.color="black")}sliderChanged(){this.printSpeed(this.elem_slider.value),this.time.sliderChanged(),this.setStorageSpeed()}printSpeed(t){this.elem_speed_msg.textContent=t+r.default.speed[this.lang]}getClickedPosition(t,e){let s;s=(t=>"touchstart"===t.type)(e)?e.touches[0]||e.changedTouches[0]:e;const a=e.target.getBoundingClientRect(),i=s.clientX-a.left-0,r=s.clientY-a.top-0,l=t.clientWidth/t.width,n=t.clientHeight/t.height;return[Math.floor(i/l),Math.floor(r/n)]}isInCircle(t,e,s){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)<=Math.pow(s,2)}getCircleNumber(t,e,s){let a=-1;for(let i=0;i<e.length;i++)this.isInCircle(t,e[i],s)&&(a=i);return a}getProbability(t,e){let s=100-(1-e[2])*t;return h.default.phi_approx_upper((s-e[0])/e[1])}getResponse(t,e,s){let a;if(0==t)a=.99;else if(a=this.getProbability(e,s[t]),a<i.default.ProbThreshold)return!1;return Math.random()<=a}displayTimer(){this.elem_timer.textContent=this.time.getTimeStr(Number(this.elem_slider.value)),requestAnimationFrame((()=>{this.displayTimer()}))}setStorageSpeed(){localStorage.setItem(i.default.storageNameSpeed,String(this.elem_slider.value))}getStorageSpeed(){return localStorage.getItem(i.default.storageNameSpeed)||"1"}setStorageLang(){localStorage.setItem(i.default.storageNameLang,String(this.lang))}getStorageLang(){const t=localStorage.getItem(i.default.storageNameLang);return t?Number(t):0}clearStorage(){localStorage.removeItem(i.default.storageNameSpeed),localStorage.removeItem(i.default.storageNameLang)}}},250:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this._isRunning=!1,this._start=Date.now(),this._elapsed=0,this._total=0,this.storageName="SimLaTime";const t=this.getStorage();Object.keys(t).length>0&&(this._isRunning=t.isRunning,this._start=t.start,this._elapsed=t.elapsed,this._total=t.total)}get isRunning(){return this._isRunning}get getMinute(){return(this._total+this._elapsed)/6e4}get getTotalTime(){return this._total}getTimeStr(t){return this.timeFormat(this.getTime(t))}getTime(t){let e;return this.isRunning?(this._elapsed=(Date.now()-this._start)*t,e=this._total+this._elapsed):e=this._total,e}timeFormat(t){return Math.floor(t/36e5)+new Date(t).toISOString().slice(13,19)}clickNewExp(){this.isRunning||(this._isRunning=!1,this._start=Date.now(),this._elapsed=0,this._total=0,this.setStorage())}clickStart(){this.isRunning?(this._isRunning=!1,this._total+=this._elapsed):(this._isRunning=!0,this._start=Date.now(),this._elapsed=0),this.setStorage()}clickQuit(){this.isRunning||this.clearStorage()}sliderChanged(){this.isRunning&&(this._total+=this._elapsed,this._start=Date.now(),this._elapsed=0,this.setStorage())}setStorage(){localStorage.setItem(this.storageName,JSON.stringify({isRunning:this._isRunning,start:this._start,elapsed:this._elapsed,total:this._total}))}getStorage(){const t=localStorage.getItem(this.storageName);return t?JSON.parse(t):{}}clearStorage(){localStorage.removeItem(this.storageName)}}},180:function(t,e,s){var a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=a(s(158));window.onload=()=>{(new i.default).start()}}},e={};!function s(a){var i=e[a];if(void 0!==i)return i.exports;var r=e[a]={exports:{}};return t[a].call(r.exports,r,r.exports,s),r.exports}(180)})();